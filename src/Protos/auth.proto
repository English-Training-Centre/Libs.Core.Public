syntax = "proto3";

option csharp_namespace = "Libs.Core.Public.Protos.AuthService";

package auth;

import "google/protobuf/empty.proto";

service AuthGrpc {
    rpc SignIn(GrpcAuthRequest) returns (GrpcAuthResponse);
    rpc RefreshToken(GrpcRefreshTokenRequest) returns (GrpcAuthResponse);
    rpc GetValidRefreshToken(GrpcTokenRequest) returns (GrpcGetTokenResponse);
    rpc RevokeRefreshToken(GrpcTokenRequest) returns (google.protobuf.Empty);
    rpc CheckSession(GrpcSessionRequest) returns (GrpcSessionResponse);
}

message GrpcAuthResponse {
    bool isSuccess = 1;
    optional string accessToken = 2;
    optional string refreshToken = 3;
}

message GrpcGetTokenResponse {
    optional string userId = 1;
}

message GrpcSessionResponse {
    bool isSuccess = 1;
    string accessToken = 2;
}

message GrpcAuthRequest {
    string username = 1;
    string password = 2;
}

message GrpcRefreshTokenRequest {
    string userId = 1;
    string refreshToken = 2;
}

message GrpcTokenRequest {
    string refreshToken = 1;
}

message GrpcSessionRequest {
    string userId = 1;
}
